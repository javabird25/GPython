
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>_luastack - Lua Stack manipulation &#8212; PyGmod 0.17-alpha documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/corlab.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pygmod._streams - I/O to Garry’s Mod" href="streams.html" />
    <link rel="prev" title="Internal modules" href="../internal.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="streams.html" title="pygmod._streams - I/O to Garry’s Mod"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../internal.html" title="Internal modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">PyGmod 0.17-alpha documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference.html" >Module Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../internal.html" accesskey="U">Internal modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">_luastack</span></code> - Lua Stack manipulation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="luastack-lua-stack-manipulation">
<h1><code class="docutils literal notranslate"><span class="pre">_luastack</span></code> - Lua Stack manipulation<a class="headerlink" href="#luastack-lua-stack-manipulation" title="Permalink to this headline">¶</a></h1>
<p>This module contains functions for manipulating the Lua stack. The lowest level of Garry’s Mod Lua interoperability.</p>
<div class="section" id="lua-stack-description">
<h2>Lua Stack description<a class="headerlink" href="#lua-stack-description" title="Permalink to this headline">¶</a></h2>
<p>Lua uses a virtual stack to pass values to and from C.
Each element in this stack represents a Lua value (<code class="docutils literal notranslate"><span class="pre">nil</span></code>, number, string, etc.).</p>
<p>For convenience, most query operations in the API do not follow a strict stack discipline.
Instead, they can refer to any element in the stack by using an index:</p>
<ul class="simple">
<li><p>A positive index represents an absolute stack position (starting at <strong>1</strong>)</p></li>
<li><p>A negative index represents an offset relative to the top of the stack.</p></li>
</ul>
<p>More specifically, if the stack has <strong>n</strong> elements, then index <strong>1</strong> represents the first element
(that is, the element that was pushed onto the stack first) and index <strong>n</strong> represents the last element;
index <strong>-1</strong> also represents the last element (that is, the element at the top)
and index <strong>-n</strong> represents the first element.
We say that an index is valid if it lies between <strong>1</strong> and the stack top (that is, if <strong>1 ≤ abs(index) ≤ top</strong>).</p>
<span class="target" id="module-_luastack"></span><dl class="py function">
<dt id="luastack.init">
<span id="_luastack.init"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lua_base_ptr</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><a class="headerlink" href="#luastack.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the internal Lua state pointer.</p>
</dd></dl>

</div>
<div class="section" id="stack-manipulation">
<h2>Stack manipulation<a class="headerlink" href="#stack-manipulation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="luastack.top">
<span id="_luastack.top"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">top</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#luastack.top" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the top element in the stack.</p>
<p>Because indices start at <strong>1</strong>,
this result is equal to the number of elements in the stack (and so <strong>0</strong> means an empty stack).</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.create_table">
<span id="_luastack.create_table"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">create_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#luastack.create_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new empty table and pushes it onto the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.push_globals">
<span id="_luastack.push_globals"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">push_globals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#luastack.push_globals" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes the globals table (aka _G) to the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.push">
<span id="_luastack.push"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">push</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a copy of the element at the given valid index onto the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.push_nil">
<span id="_luastack.push_nil"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">push_nil</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#luastack.push_nil" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes a <code class="docutils literal notranslate"><span class="pre">nil</span></code> value onto the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.pop">
<span id="_luastack.pop"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">pop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">amt</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Pops <code class="docutils literal notranslate"><span class="pre">amt</span></code> elements from the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.get_field">
<span id="_luastack.get_field"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">get_field</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span></em>, <em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.get_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes onto the stack the value <code class="docutils literal notranslate"><span class="pre">t[name]</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given valid index <code class="docutils literal notranslate"><span class="pre">stack_index</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.set_field">
<span id="_luastack.set_field"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">set_field</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span></em>, <em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.set_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the equivalent to <code class="docutils literal notranslate"><span class="pre">t[k]</span> <span class="pre">=</span> <span class="pre">v</span></code>,
where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given valid index <code class="docutils literal notranslate"><span class="pre">stack_index</span></code>
and <code class="docutils literal notranslate"><span class="pre">v</span></code> is the value at the top of the stack.</p>
<p>This function pops the value from the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.get_table">
<span id="_luastack.get_table"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">get_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><a class="headerlink" href="#luastack.get_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes onto the stack the value <code class="docutils literal notranslate"><span class="pre">t[k]</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given valid index and <code class="docutils literal notranslate"><span class="pre">k</span></code>
is the value at the top of the stack.</p>
<p>This function pops the key from the stack (putting the resulting value in its place).
As in Lua, this function may trigger a metamethod for the “index” event.”)</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.set_table">
<span id="_luastack.set_table"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">set_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><a class="headerlink" href="#luastack.set_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the equivalent to <code class="docutils literal notranslate"><span class="pre">t[k]</span> <span class="pre">=</span> <span class="pre">v</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given valid index,
<code class="docutils literal notranslate"><span class="pre">v</span></code> is the value at the top of the stack, and <code class="docutils literal notranslate"><span class="pre">k</span></code> is the value just below the top.</p>
<p>This function pops both the key and the value from the stack.
As in Lua, this function may trigger a metamethod for the “newindex” event.”)</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.call">
<span id="_luastack.call"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">results</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)">None</a><a class="headerlink" href="#luastack.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls a function.</p>
<p>To call a function you must use the following protocol:</p>
<ol class="arabic simple">
<li><p>The function to be called is pushed onto the stack</p></li>
<li><p>The arguments to the function are pushed in direct order; that is, the first argument is pushed first.</p></li>
<li><p>You call this function; <code class="docutils literal notranslate"><span class="pre">args</span></code> is the number of arguments that you pushed onto the stack.</p></li>
</ol>
<p>All arguments and the function value are popped from the stack when the function is called.
The function results are pushed onto the stack when the function returns.
The number of results is adjusted to <code class="docutils literal notranslate"><span class="pre">results</span></code>.
The function results are pushed onto the stack in direct order (the first result is pushed first),
so that after the call the last result is on the top of the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.next">
<span id="_luastack.next"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">next</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><a class="headerlink" href="#luastack.next" title="Permalink to this definition">¶</a></dt>
<dd><p>Pops a key from the stack, and pushes a key-value pair from the table at the given index
(the “next” pair after the given key).
If there are no more elements in the table, then <a class="reference internal" href="#luastack.next" title="_luastack.next"><code class="xref py py-func docutils literal notranslate"><span class="pre">next()</span></code></a> returns 0 (and pushes nothing).”)</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.reference_create">
<span id="_luastack.reference_create"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">reference_create</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><a class="headerlink" href="#luastack.reference_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new reference to an object on the top of the stack and pops that object.
Returns the reference.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.reference_push">
<span id="_luastack.reference_push"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">reference_push</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ref</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.reference_push" title="Permalink to this definition">¶</a></dt>
<dd><p>Pushes the object which the reference <code class="docutils literal notranslate"><span class="pre">ref</span></code> points to, to the top of the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.reference_free">
<span id="_luastack.reference_free"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">reference_free</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ref</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.reference_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Frees the reference <code class="docutils literal notranslate"><span class="pre">ref</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.get_type">
<span id="_luastack.get_type"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">get_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_pos</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a><a class="headerlink" href="#luastack.get_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the type of the Lua value at the given stack index.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.convert_lua_to_py">
<span id="_luastack.convert_lua_to_py"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">convert_lua_to_py</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stack_index</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.convert_lua_to_py" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a Lua value on the given index of the stack to a Python value and returns it.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.convert_py_to_lua">
<span id="_luastack.convert_py_to_lua"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">convert_py_to_lua</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">o</span></em><span class="sig-paren">)</span><a class="headerlink" href="#luastack.convert_py_to_lua" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a Python object to a Lua object and pushes it to the stack.</p>
</dd></dl>

<dl class="py function">
<dt id="luastack.stack_dump">
<span id="_luastack.stack_dump"></span><code class="sig-prename descclassname">_luastack.</code><code class="sig-name descname">stack_dump</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#luastack.stack_dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a Lua stack dump. Logs the type and the string representation of every stack object.</p>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/docs-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">_luastack</span></code> - Lua Stack manipulation</a><ul>
<li><a class="reference internal" href="#lua-stack-description">Lua Stack description</a></li>
<li><a class="reference internal" href="#stack-manipulation">Stack manipulation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../internal.html"
                        title="previous chapter">Internal modules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="streams.html"
                        title="next chapter"><code class="docutils literal notranslate"><span class="pre">pygmod._streams</span></code> - I/O to Garry’s Mod</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/reference/internal/luastack.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="streams.html" title="pygmod._streams - I/O to Garry’s Mod"
             >next</a> |</li>
        <li class="right" >
          <a href="../internal.html" title="Internal modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">PyGmod 0.17-alpha documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference.html" >Module Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../internal.html" >Internal modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="docutils literal notranslate"><span class="pre">_luastack</span></code> - Lua Stack manipulation</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, javabird25 (Protocs).
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>